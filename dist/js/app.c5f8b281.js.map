{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?0a6b","webpack:///./src/components/Login.vue?50ee","webpack:///src/components/Login.vue","webpack:///./src/components/Login.vue?00df","webpack:///./src/components/Login.vue","webpack:///./src/components/Main.vue?2dcd","webpack:///./src/components/Menu.vue?889f","webpack:///src/components/Menu.vue","webpack:///./src/components/Menu.vue?a15f","webpack:///./src/components/Menu.vue","webpack:///./src/components/ControlBar.vue?b6f7","webpack:///src/components/ControlBar.vue","webpack:///./src/components/ControlBar.vue?07c1","webpack:///./src/components/ControlBar.vue","webpack:///./src/components/Queue.vue?f284","webpack:///src/components/Queue.vue","webpack:///./src/components/Queue.vue?9d74","webpack:///./src/components/Queue.vue","webpack:///./src/player.js","webpack:///./src/database.js","webpack:///src/components/Main.vue","webpack:///./src/components/Main.vue?9d9f","webpack:///./src/components/Main.vue","webpack:///src/App.vue","webpack:///./src/App.vue?8b47","webpack:///./src/App.vue","webpack:///./src/main.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","render","_vm","this","_h","$createElement","_c","_self","attrs","isLoggedIn","_e","loginScreen","staticRenderFns","staticClass","staticStyle","_v","directives","rawName","expression","domProps","on","$event","target","composing","user","type","indexOf","_k","keyCode","login","pass","error","_s","props","methods","body","JSON","stringify","username","password","fetch","method","headers","Accept","then","response","json","state","isLoggedInParent","catch","err","console","log","component","showMenu","showControls","_player","playback","toggleQueue","showQueue","class","isActive","style","width","elapsed","queue","queuePos","duration","$innerWidth","cover","title","artist","player","random","prev","toggle","isPlaying","skip","repeat","Math","floor","_l","item","index","changePos","playerContext","AudioContext","webkitAudioContext","PLAY_MODE_HTML5","PLAY_MODE_WEBAUDIO","STATE_STOP","STATE_PLAY","STATE_PAUSE","LocalPlayer","tick","sources","html5Init","reset","gainNode","createGain","connect","destination","progressTick","_handlers","cacheWorker","Worker","handleMessageFromWorker","msg","cached","el","id","switchToWebAudio","prepareWebAudio","addEventListener","callback","eventCallbacks","event","forEach","modes","parent","self","html5Audio","Audio","controls","play","cacheQueue","dispatchEvent","Event","startTime","currentTime","timeLeft","_audio","createMediaElementSource","createBufferSource","evt","buffer","disconnect","pop","Promise","resolve","reject","mdb","indexedDB","open","onsuccess","tx","transaction","store","objectStore","e","arrayBuffer","buf","decodeAudioData","Error","onerror","loadTrack","ab","webAudioInit","curTime","playMode","pause","src","start","scheduleTime","onbeforeunload","stopAllWebAudio","progress","setTimeout","CustomEvent","detail","resume","url","parseInt","cacheState","isCached","tracks","Array","isArray","enqueueOne","playPosition","playOnLoad","postMessage","clear","enqueue","stop","items","filter","DatabaseHandler","db","loki","autoload","autoloadCallback","music","getCollection","addCollection","unique","count","update","autosave","autosaveInterval","chain","find","song","present","res","limit","offset","addSong","remove","dbSong","findOne","_id","$loki","insert","info","favorite","playCount","meta","ret","songs","albums","artists","allSongs","Set","map","albumartist","album","compoundsort","tag","array","findIndex","a","art","encodeURIComponent","subtitle","surl","artistArt","simplesort","artistart","year","shortformat","format","samplerate","bits","genre","genres","components","Menu","ControlBar","Queue","_database","getStats","Login","Main","innerWidth","h","App","$mount"],"mappings":"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","file":"js/app.c5f8b281.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[(_vm.loginScreen)?_c('Login',{attrs:{\"isLoggedInParent\":_vm.isLoggedIn}}):_vm._e(),(!_vm.loginScreen)?_c('Main',{attrs:{\"isLoggedInParent\":_vm.isLoggedIn}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\",staticStyle:{\"height\":\"100vh\"}},[_c('div',{staticClass:\"row\",staticStyle:{\"height\":\"100%\",\"align-items\":\"center\"}},[_c('div',{staticClass:\"col-xs-6 col-xs-offset-3 has-text-centered\"},[_c('img',{attrs:{\"src\":\"/img/falk-blue-white.svg\"}}),_c('h1',[_vm._v(\"Soundbyte\")]),_c('p',{staticClass:\"subtitle is-4\"},[_vm._v(\"Please login to access your music!\")]),_c('br'),_c('fieldset',{staticStyle:{\"margin\":\"0 auto\",\"max-width\":\"300px\"}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.user),expression:\"user\"}],staticClass:\"input\",attrs:{\"type\":\"text\",\"placeholder\":\"Username\",\"autofocus\":\"true\"},domProps:{\"value\":(_vm.user)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.user=$event.target.value}}})]),_c('br'),_c('fieldset',{staticStyle:{\"margin\":\"0 auto\",\"max-width\":\"300px\"}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.pass),expression:\"pass\"}],staticClass:\"input\",attrs:{\"type\":\"password\",\"placeholder\":\"Password\"},domProps:{\"value\":(_vm.pass)},on:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.login($event)},\"input\":function($event){if($event.target.composing){ return; }_vm.pass=$event.target.value}}})]),(_vm.error !== '')?_c('span',{staticClass:\"message-danger\"},[_vm._v(_vm._s(_vm.error))]):_vm._e(),_c('br'),_c('button',{staticClass:\"button is-rounded is-primary\",on:{\"click\":_vm.login}},[_vm._v(\"Log In\")])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"container\" style=\"height: 100vh\">\n    <div class=\"row\" style=\"height: 100%; align-items: center;\">\n      <div class=\"col-xs-6 col-xs-offset-3 has-text-centered\">\n        <img src=\"/img/falk-blue-white.svg\"/>\n        <h1>Soundbyte</h1>\n        <p class=\"subtitle is-4\">Please login to access your music!</p>\n        <br/>\n        <fieldset style=\"margin: 5px 0; max-width: 300px; margin: 0 auto\">\n          <input v-model=\"user\" class=\"input\" type=\"text\" placeholder=\"Username\" autofocus=\"true\" />\n        </fieldset>\n        <br/>\n        <fieldset style=\"margin: 5px 0; max-width: 300px; margin: 0 auto\">\n          <input v-model=\"pass\" class=\"input\" type=\"password\" placeholder=\"Password\" @keydown.enter=\"login\" />\n        </fieldset>\n        <span class=\"message-danger\" v-if=\"error !== ''\">{{ error }}</span>\n        <br/>\n        <button @click=\"login\" class=\"button is-rounded is-primary\">Log In</button>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nexport default {\n  name: 'Login',\n  props: [ 'isLoggedInParent' ],\n  data() {\n    return {\n      user: '',\n      pass: '',\n      error: '',\n    }\n  },\n  methods: {\n    login() {\n      const body = JSON.stringify({ username: this.user, password: this.pass })\n      window.fetch('/api/login', { method: 'post', headers: { Accept: 'application/json', 'Content-Type': 'application/json' }, body: body })\n        .then(response => response.json())\n        .then(data => {\n          if (data.state === 'failed' || data.state === false) {\n            // show a message that login failed\n            this.error = 'Invalid username and/or password'\n          } else {\n            this.isLoggedInParent()\n          }\n        })\n        .catch(err => {\n          console.log(err)\n        })\n    }\n  }\n}\n</script>\n<style scoped></style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Login.vue?vue&type=template&id=87282724&scoped=true&\"\nimport script from \"./Login.vue?vue&type=script&lang=js&\"\nexport * from \"./Login.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"87282724\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{attrs:{\"id\":\"content-container\"}}),_c('Menu',{attrs:{\"isActive\":_vm.showMenu}}),_c('ControlBar',{attrs:{\"isActive\":_vm.showControls,\"player\":_vm._player,\"playback\":_vm.playback,\"toggleQueue\":_vm.toggleQueue}}),_c('Queue',{attrs:{\"isActive\":_vm.showQueue,\"playback\":_vm.playback,\"toggleQueue\":_vm.toggleQueue}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('aside',{staticClass:\"menu\",class:{ 'is-active': _vm.isActive }},[_c('figure',{staticClass:\"image menu-brand\"},[_c('a',{attrs:{\"data-navigo\":\"\",\"href\":\"/\"}},[_c('svg',{staticStyle:{\"isolation\":\"isolate\"},attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"xmlns:xlink\":\"http://www.w3.org/1999/xlink\",\"viewBox\":\"0 0 39.961 39.961\",\"width\":\"40px\",\"height\":\"40px\"}},[_c('circle',{attrs:{\"vector-effect\":\"non-scaling-stroke\",\"cx\":\"19.9805\",\"cy\":\"19.9805\",\"r\":\"15.5\",\"fill\":\"rgb(255,255,255)\"}}),_c('path',{attrs:{\"d\":\" M 0 19.981 C 0 8.953 8.953 0 19.981 0 C 31.008 0 39.961 8.953 39.961 19.981 C 39.961 31.008 31.008 39.961 19.981 39.961 C 8.953 39.961 0 31.008 0 19.981 Z  M 15.089 28.897 L 15.089 28.897 L 10.274 28.897 L 10.274 28.897 Q 10.045 28.897 9.879 28.732 L 9.879 28.732 L 9.879 28.732 Q 9.714 28.566 9.714 28.413 L 9.714 28.413 L 9.714 28.413 Q 9.714 28.26 9.739 28.184 L 9.739 28.184 L 15.293 11.905 L 15.293 11.905 Q 15.522 11.064 16.439 11.064 L 16.439 11.064 L 23.522 11.064 L 23.522 11.064 Q 24.439 11.064 24.668 11.905 L 24.668 11.905 L 30.222 28.184 L 30.222 28.184 Q 30.248 28.26 30.248 28.413 L 30.248 28.413 L 30.248 28.413 Q 30.248 28.566 30.082 28.732 L 30.082 28.732 L 30.082 28.732 Q 29.916 28.897 29.687 28.897 L 29.687 28.897 L 24.872 28.897 L 24.872 28.897 Q 24.057 28.897 23.726 28.031 L 23.726 28.031 Q 20.444 17.551 19.981 15.981 Q 19.516 17.591 16.236 28.031 L 16.236 28.031 Q 15.904 28.897 15.089 28.897 L 15.089 28.897 L 15.089 28.897 Z \",\"fill-rule\":\"evenodd\",\"fill\":\"rgb(77,132,195)\"}})])])]),_c('ul',{staticClass:\"menu-list has-text-centered\"},[_c('li',[_c('a',{attrs:{\"href\":\"/\",\"data-navigo\":\"\"}},[_c('svg',{staticClass:\"feather\"},[_c('use',{attrs:{\"href\":\"/img/feather-sprite.svg#play\"}})]),_c('div',{staticClass:\"detail\"},[_vm._v(\"Playing\")])])]),_c('li',[_c('a',{attrs:{\"href\":\"/playlists\",\"data-navigo\":\"\"}},[_c('svg',{staticClass:\"feather\"},[_c('use',{attrs:{\"href\":\"/img/feather-sprite.svg#list\"}})]),_c('div',{staticClass:\"detail\"},[_vm._v(\"Playlists\")])])]),_c('li',[_c('a',{attrs:{\"href\":\"/artists\",\"data-navigo\":\"\"}},[_c('svg',{staticClass:\"feather\"},[_c('use',{attrs:{\"href\":\"/img/feather-sprite.svg#mic\"}})]),_c('div',{staticClass:\"detail\"},[_vm._v(\"Artists\")])])]),_c('li',[_c('a',{attrs:{\"href\":\"/albums\",\"data-navigo\":\"\"}},[_c('svg',{staticClass:\"feather\"},[_c('use',{attrs:{\"href\":\"/img/feather-sprite.svg#disc\"}})]),_c('div',{staticClass:\"detail\"},[_vm._v(\"Albums\")])])]),_c('li',[_c('a',{attrs:{\"href\":\"/genres\",\"data-navigo\":\"\"}},[_c('svg',{staticClass:\"feather\"},[_c('use',{attrs:{\"href\":\"/img/feather-sprite.svg#music\"}})]),_c('div',{staticClass:\"detail\"},[_vm._v(\"Genres\")])])]),_c('li',[_c('a',{attrs:{\"href\":\"/settings\",\"data-navigo\":\"\"}},[_c('svg',{staticClass:\"feather\"},[_c('use',{attrs:{\"href\":\"/img/feather-sprite.svg#settings\"}})]),_c('div',{staticClass:\"detail\"},[_vm._v(\"Settings\")])])]),_c('li',[_c('a',{attrs:{\"href\":\"/logout\",\"data-navigo\":\"\"}},[_c('svg',{staticClass:\"feather\"},[_c('use',{attrs:{\"href\":\"/img/feather-sprite.svg#log-out\"}})]),_c('div',{staticClass:\"detail\"},[_vm._v(\"Log Out\")])])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n      <aside class=\"menu\" :class=\"{ 'is-active': isActive }\">\n        <figure class=\"image menu-brand\">\n          <a data-navigo href=\"/\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" style=\"isolation:isolate\" viewBox=\"0 0 39.961 39.961\" width=\"40px\" height=\"40px\"><circle vector-effect=\"non-scaling-stroke\" cx=\"19.9805\" cy=\"19.9805\" r=\"15.5\" fill=\"rgb(255,255,255)\"/><path d=\" M 0 19.981 C 0 8.953 8.953 0 19.981 0 C 31.008 0 39.961 8.953 39.961 19.981 C 39.961 31.008 31.008 39.961 19.981 39.961 C 8.953 39.961 0 31.008 0 19.981 Z  M 15.089 28.897 L 15.089 28.897 L 10.274 28.897 L 10.274 28.897 Q 10.045 28.897 9.879 28.732 L 9.879 28.732 L 9.879 28.732 Q 9.714 28.566 9.714 28.413 L 9.714 28.413 L 9.714 28.413 Q 9.714 28.26 9.739 28.184 L 9.739 28.184 L 15.293 11.905 L 15.293 11.905 Q 15.522 11.064 16.439 11.064 L 16.439 11.064 L 23.522 11.064 L 23.522 11.064 Q 24.439 11.064 24.668 11.905 L 24.668 11.905 L 30.222 28.184 L 30.222 28.184 Q 30.248 28.26 30.248 28.413 L 30.248 28.413 L 30.248 28.413 Q 30.248 28.566 30.082 28.732 L 30.082 28.732 L 30.082 28.732 Q 29.916 28.897 29.687 28.897 L 29.687 28.897 L 24.872 28.897 L 24.872 28.897 Q 24.057 28.897 23.726 28.031 L 23.726 28.031 Q 20.444 17.551 19.981 15.981 Q 19.516 17.591 16.236 28.031 L 16.236 28.031 Q 15.904 28.897 15.089 28.897 L 15.089 28.897 L 15.089 28.897 Z \" fill-rule=\"evenodd\" fill=\"rgb(77,132,195)\"/></svg>\n          </a>\n        </figure>\n        <ul class=\"menu-list has-text-centered\">\n          <li><a href=\"/\" data-navigo><svg class=\"feather\"><use href=\"/img/feather-sprite.svg#play\"></use></svg><div class=\"detail\">Playing</div></a></li>\n          <li><a href=\"/playlists\" data-navigo><svg class=\"feather\"><use href=\"/img/feather-sprite.svg#list\"></use></svg><div class=\"detail\">Playlists</div></a></li>\n          <li><a href=\"/artists\" data-navigo><svg class=\"feather\"><use href=\"/img/feather-sprite.svg#mic\"></use></svg><div class=\"detail\">Artists</div></a></li>\n          <li><a href=\"/albums\" data-navigo><svg class=\"feather\"><use href=\"/img/feather-sprite.svg#disc\"></use></svg><div class=\"detail\">Albums</div></a></li>\n          <li><a href=\"/genres\" data-navigo><svg class=\"feather\"><use href=\"/img/feather-sprite.svg#music\"></use></svg><div class=\"detail\">Genres</div></a></li>\n          <li><a href=\"/settings\" data-navigo><svg class=\"feather\"><use href=\"/img/feather-sprite.svg#settings\"></use></svg><div class=\"detail\">Settings</div></a></li>\n          <li><a href=\"/logout\" data-navigo><svg class=\"feather\"><use href=\"/img/feather-sprite.svg#log-out\"></use></svg><div class=\"detail\">Log Out</div></a></li>\n        </ul>\n      </aside>\n</template>\n<script>\nexport default {\n  name: 'Menu',\n  props: [ 'isActive' ]\n}\n</script>\n<style scoped></style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Menu.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Menu.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Menu.vue?vue&type=template&id=6f6d68e2&scoped=true&\"\nimport script from \"./Menu.vue?vue&type=script&lang=js&\"\nexport * from \"./Menu.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6f6d68e2\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"is-active\",attrs:{\"id\":\"control-bar\",\"data-bind\":\"swipeup: showQueue\"}},[_c('div',{staticClass:\"progress-topper\",style:({ width: (_vm.playback.elapsed / _vm.playback.queue[_vm.playback.queuePos].duration * _vm.$innerWidth) + 'px' })}),_c('div',{staticClass:\"row is-marginless\"},[_c('div',{staticClass:\"col-xs col-md\"},[_c('div',{staticClass:\"row now-playing\"},[_c('div',{staticClass:\"col-xs is-narrow\"},[_c('figure',{staticClass:\"image is-70x70\"},[_c('img',{attrs:{\"src\":_vm.playback.queue[_vm.playback.queuePos].cover}})])]),_c('div',{staticClass:\"col-xs\"},[_c('p',{staticClass:\"is-5\"},[_vm._v(_vm._s(_vm.playback.queue[_vm.playback.queuePos].title))]),_c('p',{staticClass:\"subtitle is-5\"},[_vm._v(_vm._s(_vm.playback.queue[_vm.playback.queuePos].artist))])])])]),_c('div',{staticClass:\"col-xs no-grow col-md playing-controls misc-controls\"},[_c('svg',{staticClass:\"random feather hidden--to-desktop\",on:{\"click\":_vm.player.random}},[_c('use',{attrs:{\"href\":\"/img/feather-sprite.svg#shuffle\"}})]),_c('svg',{staticClass:\"feather prev\",on:{\"click\":_vm.player.prev}},[_c('use',{attrs:{\"href\":\"/img/feather-sprite.svg#skip-back\"}})]),_c('span',{staticClass:\"play-button pointer\",on:{\"click\":_vm.player.toggle}},[_c('svg',{staticClass:\"feather\",class:{ 'is-hidden': _vm.playback.isPlaying }},[_c('use',{attrs:{\"href\":\"/img/feather-sprite.svg#play\"}})]),_c('svg',{staticClass:\"feather\",class:{ 'is-hidden': !_vm.playback.isPlaying }},[_c('use',{attrs:{\"href\":\"/img/feather-sprite.svg#pause\"}})])]),_c('svg',{staticClass:\"feather next\",on:{\"click\":_vm.player.skip}},[_c('use',{attrs:{\"href\":\"/img/feather-sprite.svg#skip-forward\"}})]),_c('svg',{staticClass:\"repeat feather hidden--to-desktop\",on:{\"click\":_vm.player.repeat}},[_c('use',{attrs:{\"href\":\"/img/feather-sprite.svg#repeat\"}})])]),_c('div',{staticClass:\"col-md has-text-right hidden--to-desktop\"},[_c('div',{staticClass:\"row end-md\"},[_c('div',{staticClass:\"col-md no-grow play-progress\"},[_c('span',[_vm._v(_vm._s(Math.floor(_vm.playback.elapsed / 60) + ':' + ('0' + (_vm.playback.elapsed % 60)).slice(-2, 3)))]),_vm._v(\"/\"),_c('span',[_vm._v(_vm._s(Math.floor(_vm.playback.queue[_vm.playback.queuePos].duration / 60) + ':' + ('0' + (_vm.playback.queue[_vm.playback.queuePos].duration % 60)).slice(-2, 3)))])]),_c('div',{staticClass:\"col-md no-grow\"},[_c('svg',{staticClass:\"queue feather hidden--to-desktop\",on:{\"click\":_vm.toggleQueue}},[_c('use',{attrs:{\"href\":\"/img/feather-sprite.svg#queue-alt\"}})])])])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"control-bar\" class=\"is-active\" data-bind=\"swipeup: showQueue\">\n    <div class=\"progress-topper\" :style=\"{ width: (playback.elapsed / playback.queue[playback.queuePos].duration * $innerWidth) + 'px' }\"></div>\n    <div class=\"row is-marginless\">\n      <div class=\"col-xs col-md\">\n        <div class=\"row now-playing\">\n          <div class=\"col-xs is-narrow\">\n            <figure class=\"image is-70x70\">\n              <img v-bind:src=\"playback.queue[playback.queuePos].cover\">\n            </figure>\n          </div>\n          <div class=\"col-xs\">\n            <p class=\"is-5\">{{ playback.queue[playback.queuePos].title }}</p>\n            <p class=\"subtitle is-5\">{{ playback.queue[playback.queuePos].artist }}</p>\n          </div>\n        </div>\n      </div>\n      <div class=\"col-xs no-grow col-md playing-controls misc-controls\">\n        <svg class=\"random feather hidden--to-desktop\" @click=\"player.random\"><use href=\"/img/feather-sprite.svg#shuffle\"></use></svg>\n        <svg class=\"feather prev\" @click=\"player.prev\"><use href=\"/img/feather-sprite.svg#skip-back\"></use></svg>\n        <span class=\"play-button pointer\" @click=\"player.toggle\">\n          <svg class=\"feather\" :class=\"{ 'is-hidden': playback.isPlaying }\"><use href=\"/img/feather-sprite.svg#play\"></use></svg>\n          <svg class=\"feather\" :class=\"{ 'is-hidden': !playback.isPlaying }\"><use href=\"/img/feather-sprite.svg#pause\"></use></svg>\n        </span>\n        <svg class=\"feather next\" @click=\"player.skip\"><use href=\"/img/feather-sprite.svg#skip-forward\"></use></svg>\n        <svg class=\"repeat feather hidden--to-desktop\" @click=\"player.repeat\"><use href=\"/img/feather-sprite.svg#repeat\"></use></svg>\n      </div>\n      <div class=\"col-md has-text-right hidden--to-desktop\">\n        <div class=\"row end-md\">\n          <div class=\"col-md no-grow play-progress\">\n            <span>{{ Math.floor(playback.elapsed / 60) + ':' + ('0' + (playback.elapsed % 60)).slice(-2, 3) }}</span>/<span>{{ Math.floor(playback.queue[playback.queuePos].duration / 60) + ':' + ('0' + (playback.queue[playback.queuePos].duration % 60)).slice(-2, 3) }}</span>\n          </div>\n          <div class=\"col-md no-grow\">\n            <svg class=\"queue feather hidden--to-desktop\" @click=\"toggleQueue\"><use href=\"/img/feather-sprite.svg#queue-alt\"></use></svg>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nexport default {\n  name: 'ControlBar',\n  props: [ 'isActive', 'player', 'playback', 'toggleQueue' ]\n}\n</script>\n<style scoped></style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBar.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBar.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ControlBar.vue?vue&type=template&id=510d5381&scoped=true&\"\nimport script from \"./ControlBar.vue?vue&type=script&lang=js&\"\nexport * from \"./ControlBar.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"510d5381\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{ 'is-active': _vm.isActive },attrs:{\"id\":\"queue-list\"}},[_c('div',{attrs:{\"id\":\"queue-header\"},on:{\"click\":_vm.toggleQueue}},[_c('h1',[_vm._v(\"Play Queue\")])]),_c('div',{attrs:{\"id\":\"queue-items\"}},[_c('table',_vm._l((_vm.playback.queue),function(item,index){return _c('tr',{class:{ 'is-playing': index === _vm.playback.queuePos }},[_c('td',{on:{\"click\":function($event){return _vm.player.changePos(index)}}},[_c('figure',{staticClass:\"image is-40x40\"},[_c('img',{attrs:{\"src\":item.cover,\"load\":\"lazy\"}})])]),_c('td',{on:{\"click\":function($event){return _vm.player.changePos(index)}}},[_c('p',{staticClass:\"is-5\"},[_vm._v(_vm._s(item.title))]),_c('p',{staticClass:\"subtitle is-5\"},[_vm._v(_vm._s(item.artist + ' - ' + (Math.floor(item.duration / 60) + ':' + ('0' + (item.duration % 60)).slice(-2, 3))))])]),_c('td',{attrs:{\"data-bind\":\"click: $parent.queue.remove\"}},[_c('span',{staticClass:\"delete\"},[_c('svg',{staticClass:\"feather delete\"},[_c('use',{attrs:{\"xlink:href\":\"/img/feather-sprite.svg#x-circle\"}})])])])])}),0)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"queue-list\"  :class=\"{ 'is-active': isActive }\">\n    <div id=\"queue-header\" @click=\"toggleQueue\">\n      <h1>Play Queue</h1>\n    </div>\n    <div id=\"queue-items\">\n      <table>\n        <tr v-for=\"(item, index) in playback.queue\" :class=\"{ 'is-playing': index === playback.queuePos }\">\n          <td @click=\"player.changePos(index)\"><figure class=\"image is-40x40\"><img v-bind:src=\"item.cover\" load=\"lazy\"></figure></td>\n          <td @click=\"player.changePos(index)\"><p class=\"is-5\">{{ item.title }}</p><p class=\"subtitle is-5\">{{ item.artist + ' - ' + (Math.floor(item.duration / 60) + ':' + ('0' + (item.duration % 60)).slice(-2, 3)) }}</p></td>\n          <td data-bind=\"click: $parent.queue.remove\"><span class=\"delete\"><svg class=\"feather delete\"><use xlink:href=\"/img/feather-sprite.svg#x-circle\"></use></svg></span></td>\n        </tr>\n      </table>\n    </div>\n  </div>\n</template>\n<script>\nexport default {\n  name: 'Queue',\n  props: [ 'isActive', 'toggleQueue', 'playback' ]\n}\n</script>\n<style scoped></style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Queue.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Queue.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Queue.vue?vue&type=template&id=9a581dec&scoped=true&\"\nimport script from \"./Queue.vue?vue&type=script&lang=js&\"\nexport * from \"./Queue.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"9a581dec\",\n  null\n  \n)\n\nexport default component.exports","const playerContext = new (window.AudioContext || window.webkitAudioContext)()\n\nconst PLAY_MODE_HTML5 = 0\nconst PLAY_MODE_WEBAUDIO = 1\n\nconst STATE_STOP = 0\nconst STATE_PLAY = 1\nconst STATE_PAUSE = 2\n\nexport class LocalPlayer {\n  constructor (tick = 100) {\n    this.sources = []\n    this.html5Init()\n    this.reset()\n\n    this.gainNode = playerContext.createGain()\n    this.gainNode.connect(playerContext.destination)\n\n    this.progressTick = tick\n\n    this._handlers()\n\n    this.cacheWorker = new Worker('/js/player-worker.js')\n    const handleMessageFromWorker = (msg) => {\n      const data = msg.data\n      console.log('[MAIN]', data)\n      if (data.cached) {\n        for (let i = this.queuePos; i < this.queue.length; i++) {\n          let el = this.queue[i]\n          if (el.id === data.id) {\n            el.cached = true\n            if (i === this.queuePos) {\n              this.switchToWebAudio()\n            } else if (i === this.queuePos + 1) {\n              this.prepareWebAudio()\n            }\n          }\n        }\n      }\n    }\n    this.cacheWorker.addEventListener('message', handleMessageFromWorker)\n  }\n\n  /* == simple event emitter ==\n  //\n  //   attach like this:\n  //   player.on('play', evt => console.log(evt))\n  //\n  */\n  on (name, callback) {\n    this.eventCallbacks = this.eventCallbacks || {}\n    this.eventCallbacks[name] = this.eventCallbacks[name] || []\n    this.eventCallbacks[name].push(callback)\n  }\n\n  dispatchEvent (name, event) {\n    this.eventCallbacks = this.eventCallbacks || {}\n    if (name in this.eventCallbacks && this.eventCallbacks[name].length > 0) {\n      this.eventCallbacks[name].forEach(callback => callback(event))\n    }\n  }\n\n  /* == functions to get information about the state ==\n  //\n  //   get current state, queue position and the ID of the\n  //   track that's currently playing\n  //\n  */\n  currentState () {\n    const modes = ['stop', 'play', 'pause']\n    return modes[this.state]\n  }\n\n  isPaused () {\n    return this.state === STATE_PAUSE\n  }\n\n  isPlay () {\n    return this.state === STATE_PLAY\n  }\n\n  currentPos () { return this.parent.queuePos }\n\n  currentTrackID () {\n    const self = this.parent\n    if (self.queue.length > 0) {\n      return self.queue[self.queuePos].id\n    }\n    return null\n  }\n\n  /* == create an HTML5 Audio element ==\n  //\n  //   used to start playback quickly (streaming)\n  //\n  */\n  html5Init () {\n    // create the HTML5 audio element\n    this.html5Audio = new window.Audio()\n    this.html5Audio.controls = false\n    this.html5Audio.addEventListener('canplaythrough', () => {\n      this.html5Audio.play()\n      // if we're playing HTMLAudio5 then we don't have the track cached. Let's fetch it now\n      this.cacheQueue()\n    })\n    this.html5Audio.addEventListener('play', () => {\n      this.dispatchEvent('play', new window.Event('play'))\n      this.startTime = playerContext.currentTime\n      this.timeLeft = this.html5Audio.duration\n      // console.log('Playing HTML5 Audio')\n    })\n    const _audio = playerContext.createMediaElementSource(this.html5Audio)\n    _audio.connect(playerContext.destination)\n  }\n\n  /* == create an Web Audio API element ==\n  //\n  //   used for playback, we switch to this after the file is loaded\n  //   provides seeking, skipping and gapless playback\n  //\n  */\n  webAudioInit (index) {\n    this.sources[index] = playerContext.createBufferSource()\n    this.sources[index].connect(this.gainNode)\n    this.sources[index].addEventListener('ended', (evt) => {\n      if (this.state === STATE_PLAY) {\n        // this is our \"next song\" trigger, since web audio has no \"play\" event\n        // if there's another now playing...\n        if (this.sources.length) {\n          this.startTime = playerContext.currentTime\n          this.timeLeft = this.sources[0].buffer.duration\n        } else {\n          this.startTime = -1\n          this.timeLeft = -1\n        }\n\n        // shift the queue on\n        this.queuePos++\n        // increment this song's timesPlayed in the localdb and backend <---------------------------------------------------------\n\n        // tidy up this mess...\n        evt.target.disconnect(0)\n        if (evt.target.buffer) {\n          evt.target.buffer = null\n        }\n        this.sources.shift()\n\n        // if we're not at the end of the queue\n        if (this.queue[this.queuePos + 1]) {\n          this.dispatchEvent('next', new window.Event('next'))\n          this.prepareWebAudio()\n          this.cacheQueue()\n        } else {\n          this.queuePos = 0\n          this.dispatchEvent('stop', new window.Event('stop'))\n        }\n      }\n    })\n  }\n\n  stopAllWebAudio () {\n    for (let i = this.sources.length - 1; i >= 0; i--) {\n      this.sources[i].disconnect(0)\n      this.sources.pop()\n    }\n  }\n\n  /* == try to read the track from IndexedDB ==\n  //\n  //   retrieve a track from the cache\n  //\n  */\n  loadTrack (index) {\n    return new Promise((resolve, reject) => {\n      const mdb = window.indexedDB.open('falk', 2).onsuccess = mdb => {\n        const tx = mdb.target.result.transaction('cache', 'readonly')\n        const store = tx.objectStore('cache')\n\n        const item = this.queue[index]\n\n        store.get(item.id).onsuccess = (e) => {\n          if (e.target.result) {\n            e.target.result.data.arrayBuffer()\n              .then(buf => {\n                console.log('[MAIN] Loaded track ', item.id)\n                playerContext.decodeAudioData(buf, function (buffer) {\n                  resolve(buffer)\n                })    \n              })\n              .catch(e => reject(new Error('Cache invalid')))\n          } else {\n            reject(new Error('Not in cache'))\n            console.log(item)\n          }\n        }\n        tx.onerror = (e) => reject(e) // the store doesn't existself.path + \n      }\n      mdb.onerror = (e) => reject(e) // couldn't open the database\n    })\n  }\n\n  /* == check if the track is cached in IndexedDB ==\n  //\n  //   check the IndexedDB db to see if this track is cached\n  //\n  */\n  isCached (id) {\n    return new Promise((resolve, reject) => {\n      const mdb = window.indexedDB.open('falk', 2).onsuccess = mdb => {\n        const tx = mdb.target.result.transaction('cache', 'readonly')\n        const store = tx.objectStore('cache')\n\n        store.get(id).onsuccess = (e) => {\n          if (e.target.result) {\n            resolve(true)\n          } else {\n            // the track isn't in the database\n            resolve(false)\n          }\n        }\n        tx.onerror = (e) => reject(e) // the store doesn't exist\n      }\n      mdb.onerror = (e) => reject(e) // couldn't open the database\n    })\n  }\n\n  switchToWebAudio () {\n    this.loadTrack(this.queuePos, true)\n      .then(ab => {\n        this.webAudioInit(0)\n        this.sources[0].buffer = ab\n        console.log('Switching to Web Audio API')\n        const curTime = this.html5Audio.currentTime\n        this.playMode = PLAY_MODE_WEBAUDIO\n        if (this.state === STATE_PLAY) {\n          this.html5Audio.pause()\n          this.html5Audio.src = ''\n          this.sources[0].start(0, curTime)\n        }\n      })\n  }\n\n  prepareWebAudio () {\n    this.loadTrack(this.queuePos + 1, true)\n      .then(ab => {\n        this.webAudioInit(1)\n        this.sources[1].buffer = ab\n        const scheduleTime = this.startTime + this.timeLeft\n        this.sources[1].start(scheduleTime)\n        console.log('[MAIN] Next song scheduled')\n      })\n  }\n\n  _handlers () {\n    window.onbeforeunload = () => {\n      this.stopAllWebAudio()\n      return null\n    }\n    this.progress = () => {\n      if (this.state === STATE_PLAY) {\n        window.setTimeout(this.progress, this.progressTick)\n        const duration = this.html5Audio.duration || ((this.sources[0]) ? this.sources[0].buffer.duration : null) || false\n        if (duration !== false) {\n          this.dispatchEvent('progress', new window.CustomEvent('progress', { detail: { elapsed: duration - (this.timeLeft - (playerContext.currentTime - this.startTime)), duration: duration } }))\n        }\n      }\n    }\n  }\n\n  /* == called when the track isn't in the cache ==\n  //\n  //   Test function\n  //\n  */\n  play (index = -1) {\n    // resume, in case user left / returned\n    playerContext.resume()\n\n    // first, check if we're paused and we haven't loaded the web audio - just start playing\n    if (this.state === STATE_PAUSE && this.playMode === PLAY_MODE_HTML5) {\n      this.html5Audio.play()\n      return\n    }\n\n    // if no index was provided, use the current queue position\n    if (index < 0) {\n      index = this.queuePos\n    }\n\n    // check the request is a position in the queue\n    if (this.queue.length < 0 || index >= this.queue.length) {\n      throw new Error('Invalid queue position')\n    }\n\n    // if we're already playing, stop\n    if (this.state === STATE_PLAY) {\n      if (this.playMode === PLAY_MODE_HTML5) {\n        this.html5Audio.pause()\n        this.html5Audio.src = ''\n        this.timeLeft = 0\n        this.startTime = 0\n      } else {\n        // supress 'ended' messages for web audio elements\n        this.state = STATE_STOP\n        this.stopAllWebAudio()\n      }\n    }\n\n    const item = this.queue[index]\n\n    // check to see if the song is in the cache before we start playing the html5audio element\n    if (item.cached) {\n      this.loadTrack(index, true)\n        .then(ab => {\n          this.webAudioInit(0)\n          this.sources[0].buffer = ab\n          const start = ((this.state === STATE_PAUSE) ? this.sources[0].buffer.duration - this.timeLeft : 0)\n          this.sources[0].start(0, start)\n\n          this.startTime = playerContext.currentTime\n          if (this.state !== STATE_PAUSE) {\n            this.timeLeft = this.sources[0].buffer.duration\n          }\n\n          // console.log('Playing Web Audio API from queue data')\n          this.dispatchEvent('play', new window.Event('play'))\n  \n          this.playMode = PLAY_MODE_WEBAUDIO\n  \n          if (this.queue[index + 1] && this.queue[index + 1].cached) {\n            // queue up next song if we already have the data in cache (if not, it will be loaded after it's cached)\n            this.prepareWebAudio()\n          }\n  \n        })\n    } else {\n      this.html5Audio.src = item.url\n      this.playMode = PLAY_MODE_HTML5\n    }\n    this.state = STATE_PLAY\n    this.progress()\n  }\n\n  /* == pauses playback\n  //\n  //   determine playback type and pause / stop\n  //\n  */\n  pause () {\n    if (this.state !== STATE_PLAY) {\n      return\n    }\n    this.state = STATE_PAUSE\n    this.dispatchEvent('pause', new window.Event('pause'))\n    if (this.playMode === PLAY_MODE_HTML5) {\n      this.timeLeft = this.timeLeft - (playerContext.currentTime - this.startTime)\n      this.html5Audio.pause()\n    } else if (this.playMode === PLAY_MODE_WEBAUDIO) {\n      this.timeLeft = this.timeLeft - (playerContext.currentTime - this.startTime)\n      this.stopAllWebAudio()\n    }\n  }\n\n  toggle () {\n    if (this.state === STATE_PLAY) {\n      this.pause()\n    } else {\n      this.play()\n    }\n  }\n\n  stop () {\n    if (this.playMode === PLAY_MODE_HTML5) {\n      this.html5Audio.pause()\n      this.html5Audio.src = ''\n    } else {\n      this.stopAllWebAudio()\n    }\n    this.state = STATE_STOP\n    this.dispatchEvent('stop', new window.Event('stop'))\n    this.timeLeft = 0\n    this.startTime = 0\n    this.queuePos = 0\n  }\n\n  skip () {\n    this.changePos(this.queuePos + 1)\n  }\n\n  prev () {\n    // check how long we've been playing for, if it's less than three seconds\n    // then skip back, otherwise just start at the beginning of the song\n    this.changePos(this.queuePos - 1)\n  }\n\n  random () {\n\n  }\n\n  repeat () {\n    \n  }\n\n  async enqueueOne ({ id, url }) {\n    id = parseInt(id) || false\n    url = url || false\n    // check to make sure we have valid results\n    if (id !== false && url !== false) {\n      let cacheState = false\n      try {\n        cacheState = await this.isCached(id)\n      } catch(e) {\n        console.log(e)\n      }\n      // define the item\n      const item = { id: id, url: url, data: null, cached: cacheState }\n      // add to the array\n      const len = this.queue.push(item)\n    }\n  }\n\n  async enqueue (tracks) {\n    if (Array.isArray(tracks)) {\n      for (let i = 0; i < tracks.length; i++) {\n        await this.enqueueOne(tracks[i])\n      }\n    }\n  }\n\n  async setTracks (tracks, playPosition = 0, playOnLoad = false) {\n    this.reset()\n    this.cacheWorker.postMessage({ clear: true })\n    this.queuePos = playPosition\n    await this.enqueue(tracks)\n    if (playOnLoad) {\n      this.play()\n    }\n  }\n\n  changePos (index) {\n    this.stop()\n    // as long as the queue position is valid, set it\n    if (this.queue[index]) {\n      this.queuePos = index\n    }\n    // need to clear audio buffers for songs no longer in the immediate queue\n    this.play()\n  }\n\n  populateQueue() {\n    if (this.queue.length > 0) {\n      for (let i = this.queuePos; i < this.queue.length && i <= this.queuePos + 3; i++) {\n        console.log(this.queue[i])\n      }\n    }\n  }\n\n  clearQueue () {\n    this.reset()\n  }\n\n  cacheQueue() {\n    // get a list of songs in the queue, loading only the next five songs\n    const items = this.queue.slice(this.queuePos).filter(e => e.cached === false).slice(0, 5)\n    this.cacheWorker.postMessage({ items: items })\n    // need to clear data from old songs\n  }\n\n  reset () {\n    this.state = STATE_STOP\n    this.playMode = false\n\n    this.stopAllWebAudio()\n    this.html5Audio.src = ''\n\n    this.startTime = -1\n    this.timeLeft = -1\n\n    this.queue = []\n    this.queuePos = 0\n  }\n}\n","export class DatabaseHandler {\n    constructor (callback) {\n      this.db = new loki ('falkns0113.db', {\n        autoload: true,\n        autoloadCallback: () => {\n          // load the collection (or create if it's empty)\n          this.music = this.db.getCollection('songs')\n          if (!this.music) {\n            this.music = this.db.addCollection('songs', { unique: ['id'] })\n          }\n          //  if there's at least some music, call the callback\n          if (this.music.count() > 0 && typeof callback === 'function') {\n            callback()\n            this.update()\n          } else {\n            // otherwise we might as well load the database before we begin\n            this.update(callback)\n          }\n        },\n        autosave: true,\n        autosaveInterval: 4000\n      })\n    }\n  \n    async update (callback) {\n      callback = callback || null\n      // load the data from the API (needs some error handling)\n      try {\n        // reset all songs to be missing\n        this.music.chain().find().update((song) => {\n          song.present = false\n        })\n  \n        let response = await window.fetch('/api/songs/all')\n        let res = await response.json()\n        const limit = res.data.length\n        let offset = limit\n        // pull the remaining songs from the API, using the limit provided by the API\n        do {\n          res.data.forEach(s => {\n            this.addSong(s)\n          })\n  \n          response = await window.fetch('/api/songs/all/' + offset + '/' + limit)\n          res = await response.json()\n          offset = offset + res.data.length\n        } while (res.data.length > 0)\n  \n        // remove anything we haven't seen\n        this.music.chain().find({ present: false }).remove()\n      } catch (e) {\n        console.log('Could not connect to API to update library', e)\n      }\n      if (callback !== null) {\n        callback()\n      }\n    }\n  \n    addSong (song) {\n      try {\n        // get the song from the database using the index (very fast!)\n        const dbSong = this.music.findOne({ _id: song.$loki }) || null\n        // if the song isn't in the database\n        if (dbSong === null) {\n          // simply insert it, then correct the ID and metadata as sent by the server\n          const s = this.music.insert({ _id: song.$loki, info: song.info, favorite: song.favorite, playCount: song.playCount, cached: false, present: true })\n          s.meta = song.meta\n          this.music.update(s)\n        } else {\n          // the song already exists, let's check if the metadata has changed\n          if (JSON.stringify(dbSong.info) !== JSON.stringify(song.info)) {\n            // info has changed, update\n            dbSong.info = song.info\n            // mark the song as in the database\n            // now we need to check to see if the other data has changed... <----------------------------------------------------------\n          }\n          dbSong.present = true\n          this.music.update(dbSong)\n        }\n      } catch (e) {\n        console.error('Could not add song to database', e)\n      }\n    }\n  \n    async getStats () {\n      const ret = { songs: 0, albums: 0, artists: 0 }\n      const allSongs = this.music.find()\n      ret.songs = allSongs.length\n      ret.artists = [...new Set(allSongs.map(song => song.info.albumartist))].length\n      ret.albums = [...new Set(allSongs.map(song => song.info.album))].length\n      return ret\n    }\n  \n    async getArtists () {\n      const artists = this.music.chain().find().compoundsort([['info.artist.art', true], 'info.albumartist']).data()\n      return artists\n        .filter((tag, index, array) => array.findIndex(t => t.info.albumartist === tag.info.albumartist) === index)\n        .map(a => { return { title: a.info.albumartist, art: '/art/' + ((a.info.art.artist !== '') ? a.info.art.artist : 'placeholder.png'), url: `/artist/${encodeURIComponent(a.info.albumartist)}`, subtitle: '', surl: '' } })\n    }\n  \n    async getArtist (artist) {\n      // const s_artist = this.artists.by('name', artist) || null\n      const artistArt = this.music.chain().find({ 'info.albumartist': artist }).compoundsort([['info.artist.art', true], 'info.albumartist']).limit(1).data()[0].info.art.artist\n      const songs = this.music.chain().find({ 'info.albumartist': artist }).simplesort('info.year').data()\n      const albums = songs.map(e => {\n        return {\n          art: '/art/' + ((e.info.art.cover !== '') ? e.info.art.cover : 'placeholder.png'),\n          artistart: '/art/' + ((artistArt !== '') ? artistArt : 'placeholder.png'),\n          title: e.info.album,\n          url: `/album/${encodeURIComponent(e.info.albumartist)}/${encodeURIComponent(e.info.album)}`,\n          subtitle: e.info.year,\n          surl: ''\n        }\n      }).filter((tag, index, array) => array.findIndex(t => t.title === tag.title && t.subtitle === tag.subtitle) === index)\n      return { albums: albums }\n    }\n  \n    async getAlbums () {\n      const songs = this.music.chain().find().simplesort('info.album').data()\n      const albums = songs.map(e => {\n        return {\n          art: '/art/' + ((e.info.art.cover !== '') ? e.info.art.cover : 'placeholder.png'),\n          title: e.info.album,\n          url: `/album/${encodeURIComponent(e.info.albumartist)}/${encodeURIComponent(e.info.album)}`,\n          subtitle: e.info.albumartist,\n          surl: `/artist/${encodeURIComponent(e.info.albumartist)}`\n        }\n      }).filter((tag, index, array) => array.findIndex(t => t.title === tag.title && t.subtitle === tag.subtitle) === index)\n      return albums\n    }\n  \n    async getAlbum (artist, album) {\n      const data = this.music.chain().find({ 'info.albumartist': artist, 'info.album': album }).compoundsort(['info.disc', 'info.track']).data()\n      const info = data.map(s => {\n        s.info._id = s._id\n        s.info.shortformat = (s.info.format.samplerate / 1000) + 'kHz ' + ((s.info.format.bits) ? s.info.format.bits + 'bit' : '')\n        s.info.artist = ((s.info.artists.length > 0) ? s.info.artists[0] : s.info.albumartist)\n        s.info.art.cover = ((s.info.art.cover !== '') ? s.info.art.cover : 'placeholder.png')\n        return s.info\n      })\n      return {\n        title: info[0].album,\n        art: '/art/' + info[0].art.cover,\n        artist: info[0].albumartist,\n        year: info[0].year,\n        genre: info[0].genre,\n        shortformat: info[0].shortformat,\n        tracks: info\n      }\n    }\n  \n    async getGenres () {\n      const songs = this.music.chain().find().simplesort('info.genre').data()\n      const genres = songs.map(e => {\n        return {\n          art: '/art/' + ((e.info.art.cover) ? e.info.art.cover : 'placeholder.png'),\n          title: e.info.genre,\n          url: `/genre/${encodeURIComponent(e.info.genre)}`,\n          subtitle: '',\n          surl: ''\n        }\n      }).filter((tag, index, array) => array.findIndex(t => t.title === tag.title && t.title !== '') === index)\n      return genres\n    }\n  \n    async getGenre (genre) {\n      const songs = this.music.chain().find({ 'info.genre': genre }).simplesort('info.album').data()\n      const albums = songs.map(e => {\n        return {\n          art: '/art/' + ((e.info.art.cover) ? e.info.art.cover : 'placeholder.png'),\n          title: e.info.album,\n          url: `/album/${encodeURIComponent(e.info.albumartist)}/${encodeURIComponent(e.info.album)}`,\n          subtitle: e.info.albumartist,\n          surl: `/artist/${encodeURIComponent(e.info.albumartist)}`\n        }\n      }).filter((tag, index, array) => array.findIndex(t => t.title === tag.title && t.subtitle === tag.subtitle) === index)\n      return albums\n    }\n  }","<template>\n  <div>\n    <div id=\"content-container\"></div>\n    <Menu :isActive=\"showMenu\" />\n    <ControlBar :isActive=\"showControls\" :player=\"_player\" :playback=\"playback\" :toggleQueue=\"toggleQueue\" />\n    <Queue :isActive=\"showQueue\" :playback=\"playback\" :toggleQueue=\"toggleQueue\" />\n  </div>\n</template>\n<script>\nimport Menu from './Menu.vue'\nimport ControlBar from './ControlBar.vue'\nimport Queue from './Queue.vue'\n\nimport { LocalPlayer } from '../player.js'\nimport { DatabaseHandler } from '../database.js'\n\nexport default {\n  name: 'Main',\n  components: {\n    Menu,\n    ControlBar,\n    Queue\n  },\n  created() {\n    this._player = new LocalPlayer()\n    this._database = new DatabaseHandler(() => {\n      this._database.getStats().then(e => console.log(e))\n      // here we need to load the router\n    })\n  },\n  data () {\n    return {\n      showMenu: false,\n      showControls: false,\n      showQueue: true,\n      playback: {\n        isPlaying: false,\n        queuePos: 1,\n        elapsed: '53',\n        queue: [\n          {\n            title: 'The Only Night',\n            artist: 'James Morrison',\n            duration: '217',\n            cover: '/art/4be59c8690054a786e401f40177c41a76b8caee0-cover.jpg',\n          },\n          {\n            title: 'Precious Love',\n            artist: 'James Morrison',\n            duration: '218',\n            cover: '/art/4be59c8690054a786e401f40177c41a76b8caee0-cover.jpg',\n          }\n        ]\n      },\n    }\n  },\n  props: [ 'isLoggedInParent' ],\n  methods: {\n    toggleQueue () {\n      this.showQueue = !this.showQueue\n    }\n  }\n}\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Main.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Main.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Main.vue?vue&type=template&id=15594305&\"\nimport script from \"./Main.vue?vue&type=script&lang=js&\"\nexport * from \"./Main.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"app\">\n    <Login v-if=\"loginScreen\" :isLoggedInParent=\"isLoggedIn\" />\n    <Main v-if=\"!loginScreen\" :isLoggedInParent=\"isLoggedIn\" />\n  </div>\n</template>\n<script>\nimport Login from './components/Login.vue'\nimport Main from './components/Main.vue'\nexport default {\n  name: 'App',\n  components: {\n    Login,\n    Main\n  },\n  data() {\n    return {\n      loginScreen: true,\n    }\n  },\n  methods: {\n    isLoggedIn(state = true) {\n      this.loginScreen = !state\n    }\n  }\n}\n</script>\n<style></style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=670cbbd3&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport App from './App.vue'\n\nVue.prototype.$innerWidth = window.innerWidth\n\nnew Vue({\n  render: h => h(App)\n}).$mount('#app')"],"sourceRoot":""}